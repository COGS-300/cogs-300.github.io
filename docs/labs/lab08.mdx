---
title: Lab 08. Line-following
draft: true
---

import YouTube from '@site/src/components/YouTube';

This is the last lab with new content before the tournament. Everything else is directly tournament prep. Today, we will be learning how to do line-following. You will have two options for the final tournament: photocells and IR sensors. We will implement the photocell version. IR sensors are often more precise, but they give binary outputs, so they are less adaptable. As with everything, there are design tradeoffs for the equipment you use.


---
## Pre-lab

### Explanation of the IR sensor
This video briefly explains the IR sensor that we'll be using.
<YouTube id="g1dmP5EUEA8" />

### Line-following robots
This demonstrates a line-following robot in the world outside of COGS.
<YouTube id="bU0I_9FBy48" />

---
## Lab
For this lab, we'll be focusing on creating line-following robots. In some ways, they're simpler than wall-following robots. In other ways, they're much harder. It all depends on the mix between detection and emergence.

From a detection perspective, you may consider it important for your robot to detect the state of the line and itself. You can use all of the signal-processing and modelling techniques we've discussed so far: threshold filters, average filters, Bayes filters, or Bayes networks. Those will come in handy for many things that are really important to detect. 

However, from an emergence perspective, you may consider that it's not very important that the robot "knows" its own state, or the state of the environment. You may instead decide that as long as it "works it works." Emergently "detecting" a corner may not involve any explicit detection whatsoever; instead, the robot may just follow a very simple algorithm of bouncing back and forth across the line.

We'll try both in this lab, starting with the emergent algorithm, and ending with the detection algorithm.

### 1. Wire, test, and tune IR sensors
![IR Sensor wiring diagram](/img/IR-sensor.png)

Start by wiring a demo version of the IR sensor to a spare Arduino. Your IR sensor may have three or four header pins that you can wire to your Arduino. The easiest to use will be the one that has a `D` for digital output. However, if you do have an `A` for analog or somethint that simply says `out`, you may also be able to get readings that vary.

Notice that the IR sensor has a little potentiometer on it. You can turn it to change the sensitivity threshold for the sensor to output a `HIGH` signal. For most models, you can also see a little LED that will turn `ON` when the sensor detects something reflective.

Tune the IR to reliably differentiate pure white from a background colour, such as the floor or a table. You may have to tune the sensor more than once, particularly if lighting conditions change, the thing you're detecting changes, or the background you're differentiating from changes!


### 2. Add one or more IR sensors to your robot
Now that you have a working IR sensor, add at least one to your robot. You can add up to three later, but not everyone needs three, so start with one. Go through the same process as above tuning the robot. Put a piece of white tape on the floor or desk, or use a piece of paper. Make sure the IR sensor is turned to work in multiple environments.


### 3. Make a line-detecting robot
Put two pieces of tape parallel on the floor and spaced out by a couple of feet. One piece will be the start. One will be the end. Make the robot start on a line, drive foward, and stop on the second line.

An advanced version would be a robot that starts without a line, detects the first line, stops, starts again, finds the second line, does a 180, then drives until the second line, does a 180, repeat. This will be very hard, so try it only after the rest of the lab.


### 4. Make a line-following robot
Your goal for this section is to make a robot that simply follows the line. For the moment, nothing fancy is needed. The robot should drive forwards along the length of a long piece of white tape. If it veers off of the tape, it should turn back towards the tape. It's best think about this in slow motion. Draw out cases for the robot moving millisecond-by-millisecond. 

For example, if you have only one IR sensor on your robot, you can detect only if the robot is on or off of the white tape. But you can use your motor signals to give you a clue about how to make the robot behave. So, if the robot was turning left, and now it doesn't detect the tape, try turning right until the robot detects the tape again. However, if you have more than one IR sensor, you might be able to get away without storing information about how the robot was previously moving.

Design the algorithm for the simplest possible line following and implement on your robot.


### 5. Advanced line-following (homework)
Come up with an advanced version of the line-following robot. For example, you could figure out how to turn different types of corners. Or, how to detect start the start and stop of the line. Or, add a remote line detecting debugger using Processing. Or, simply make a very fast version of the line-following.

As usual, you will be marked on the following scale:

- 5: Exceptional demonstration of lab concepts (exceeds requirements)
- 4: Good demonstration of lab concepts (meets requirements)
- 3: Reasonable demonstration of lab concepts (one or two requirements unclear)
- 2: Missing one or two lab concepts
- 1: Missing most lab concepts
- 0: No attendance/no completion.